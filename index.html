<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LMS — Початок (Debug)</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Inter:wght@300;400;500;600&display=swap');
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{overflow:hidden;background:#000;color:#f3eed7}

    #wrap{
      position:fixed; inset:0;
      background:
        radial-gradient(1200px 700px at 50% 45%,
          rgba(70,85,180,.22),
          rgba(10,10,18,.92) 60%,
          #000 100%);
    }
    canvas{display:block;width:100%;height:100%}

    #vignette{
      position:fixed; inset:-2px;
      background: radial-gradient(1200px 800px at 50% 50%, transparent 40%, rgba(0,0,0,.72) 100%);
      pointer-events:none;
      z-index:1;
      opacity:.9;
    }

    .intro{
      position:fixed; inset:0;
      display:flex; flex-direction:column;
      align-items:center; justify-content:center;
      text-align:center;
      padding:6vw;
      z-index:2;
      pointer-events:none;
      transition: opacity 1.2s ease;
    }
    .intro::before{
      content:"";
      position:absolute;
      width:min(980px,92vw);
      height:min(520px,60vh);
      border-radius:999px;
      background: radial-gradient(closest-side, rgba(0,0,0,.62), rgba(0,0,0,0));
      z-index:-1;
    }

    h1{
      margin:0 0 1.1rem;
      font-family:"Cormorant Garamond", serif;
      font-weight:500;
      font-size:clamp(3.0rem, 7.6vw, 6.8rem);
      line-height:.92;
      letter-spacing:-0.01em;
      color:rgba(243,238,215,.96);
      text-shadow: 0 24px 80px rgba(0,0,0,.55);
    }
    .subtitle{
      margin:0 0 2.4rem;
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size:clamp(1.05rem,2.2vw,1.5rem);
      opacity:.86;
      line-height:1.55;
      max-width:820px;
    }

    #startBtn{
      pointer-events:auto;
      padding:1rem 3.5rem;
      font-size:.95rem;
      letter-spacing:.32em;
      text-transform:uppercase;
      background:transparent;
      border:1.5px solid rgba(243,238,215,.55);
      color:#f3eed7;
      cursor:pointer;
      transition:transform .35s ease, background .35s ease, border-color .35s ease;
    }
    #startBtn:hover{
      border-color: rgba(243,238,215,.92);
      background: rgba(243,238,215,.08);
      transform: translateY(-3px);
    }

    #debug{
      position:fixed; left:10px; bottom:10px;
      z-index:5;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:13px;
      background:rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.12);
      padding:10px 12px;
      border-radius:10px;
      color:rgba(243,238,215,.92);
      pointer-events:none;
      white-space:pre;
    }

    #fade{
      position:fixed; inset:0;
      background:#000;
      opacity:0;
      transition: opacity 1.1s ease;
      pointer-events:none;
      z-index:4;
    }
    body.flying .intro{opacity:0}
  </style>
</head>

<body>
  <div id="wrap"></div>
  <div id="vignette"></div>

  <div class="intro">
    <h1>Навчання — це подорож</h1>
    <p class="subtitle">Крізь час і знання</p>
    <button id="startBtn">ПОЧАТИ</button>
  </div>

  <div id="debug">DEBUG: loading…</div>
  <div id="fade"></div>

  <script type="module">
    import * as THREE from "https://unpkg.com/three@0.161.0/build/three.module.js";

    const wrap = document.getElementById("wrap");
    const btn  = document.getElementById("startBtn");
    const fade = document.getElementById("fade");
    const dbg  = document.getElementById("debug");

    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true });
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.setSize(window.innerWidth, window.innerHeight);
    wrap.appendChild(renderer.domElement);

    const scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x000000, 6, 120);

    const camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 0.1, 260);
    camera.position.set(0, 0, 16);

    // BIG visible markers (неможливо не побачити рух)
    function makePoints(count, zNear, zFar, size, opacity){
      const pos = new Float32Array(count * 3);
      for(let i=0;i<count;i++){
        const k = i*3;
        pos[k+0] = (Math.random()-0.5) * 90;
        pos[k+1] = (Math.random()-0.5) * 50;
        pos[k+2] = -(zNear + Math.random()*(zFar-zNear));
      }
      const geo = new THREE.BufferGeometry();
      geo.setAttribute("position", new THREE.BufferAttribute(pos, 3));
      const mat = new THREE.PointsMaterial({
        color: 0xf3eed7,
        size,
        transparent:true,
        opacity,
        depthWrite:false
      });
      const pts = new THREE.Points(geo, mat);
      scene.add(pts);
      return pts;
    }

    const near = makePoints(500, 4, 30, 0.18, 0.28);   // ВЕЛИКІ точки
    const mid  = makePoints(900, 30, 80, 0.10, 0.18);
    const far  = makePoints(1400, 80, 170, 0.06, 0.14);

    // target from mouse
    let mx = 0, my = 0;
    window.addEventListener("mousemove", (e)=>{
      mx = (e.clientX / window.innerWidth  - 0.5);
      my = (e.clientY / window.innerHeight - 0.5);
    });

    // button
    let flying = false;
    btn.addEventListener("click", ()=>{
      if (flying) return;
      flying = true;
      document.body.classList.add("flying");
      fade.style.opacity = "1";
      btn.style.pointerEvents = "none";
      setTimeout(()=>{ location.href = "./main.html#overview"; }, 850);
    });

    function animate(){
      const t = performance.now() * 0.001;

      // AUTO MOVE (щоб ти бачив навіть без мишки)
      const autoX = Math.sin(t * 0.55) * 6.0;
      const autoY = Math.cos(t * 0.42) * 3.6;

      // MIX mouse + auto
      const tx = autoX + mx * 8.0;
      const ty = autoY - my * 5.0;

      // Camera moves (parallax = 100% visible)
      camera.position.x += (tx - camera.position.x) * 0.06;
      camera.position.y += (ty - camera.position.y) * 0.06;

      camera.lookAt(tx * 0.18, ty * 0.18, -40);

      // subtle swirl (to show motion)
      near.rotation.z = Math.sin(t * 0.35) * 0.06;
      mid.rotation.z  = Math.sin(t * 0.28) * 0.04;
      far.rotation.z  = Math.sin(t * 0.22) * 0.03;

      // DEBUG текст (координати точно мають мінятись)
      dbg.textContent =
`DEBUG
camera.x: ${camera.position.x.toFixed(2)}
camera.y: ${camera.position.y.toFixed(2)}
mouse.x : ${mx.toFixed(2)}
mouse.y : ${my.toFixed(2)}
(auto is ON)`;

      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);

    window.addEventListener("resize", ()=>{
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    });
  </script>
</body>
</html>
