<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>LMS — Intro</title>

<style>
  /* близько до вайбу 100lostspecies: елегантний serif + clean sans */
  @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Inter:wght@300;400;500&display=swap');

  *{box-sizing:border-box}
  html,body{
    margin:0; padding:0; height:100%;
    background:#05070d; color:#e8eefc;
    overflow:hidden;
  }

  /* ================= INTRO ================= */
  #intro{
    position:fixed; inset:0;
    background:
      radial-gradient(1200px 700px at 50% 40%, rgba(106,167,255,.12), transparent 55%),
      radial-gradient(900px 650px at 70% 70%, rgba(120,255,204,.06), transparent 55%),
      #05070d;
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:10;
    transition: opacity 1.1s ease;
  }

  #stage{
    position:absolute; inset:0;
    perspective: 950px;
    transform-style: preserve-3d;
    overflow:hidden;
    pointer-events:none;
  }

  #cloud{
    position:absolute; inset:0;
    transform-style: preserve-3d;
    pointer-events:none;
  }

  .intro-content{
    position:relative;
    z-index:3;
    text-align:center;
    width:min(980px, 92vw);
    padding:24px;
    pointer-events:none;
  }

  .intro-content h1{
    font-family:"Cormorant Garamond", serif;
    font-weight:500;
    margin:0 0 14px;
    letter-spacing:.01em;
    font-size: clamp(46px, 6.2vw, 92px);
    line-height:1.02;
    text-wrap: balance;
  }

  .intro-content p{
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    margin:0 0 30px;
    opacity:.72;
    line-height:1.65;
    font-size: clamp(13px, 1.45vw, 16px);
  }

  #enterBtn{
    pointer-events:auto;
    opacity:0;
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    font-weight:400;
    padding:12px 30px;
    background:transparent;
    border:1px solid rgba(255,255,255,.35);
    color:#e8eefc;
    letter-spacing:.18em;
    text-transform:uppercase;
    cursor:pointer;
    transition:opacity 1.2s ease, border-color .3s ease, transform .25s ease;
    user-select:none;
  }
  #enterBtn:hover{ border-color:#fff; transform:translateY(-1px); }

  /* --- YEARS (text only, no bubbles) --- */
  .year{
    position:absolute;
    left:0; top:0;
    transform-style:preserve-3d;
    will-change: transform, opacity, filter;
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    font-size:12px;
    letter-spacing:.12em;
    color: rgba(232,238,252,.95);
    white-space:nowrap;
    text-shadow: 0 0 14px rgba(0,0,0,.55);
    user-select:none;
    pointer-events:none;
  }

  /* ================= MAP ================= */
  #wrap{
    position:fixed; inset:0;
    opacity:0; pointer-events:none;
    transition: opacity 1s ease;
    z-index:1;
  }
  #space{
    position:absolute;
    left:50%; top:50%;
    width:3000px; height:2000px;
    transform: translate(-50%,-50%) scale(1);
    background:
      radial-gradient(800px 400px at 30% 30%, rgba(106,167,255,.15), transparent 50%),
      radial-gradient(700px 500px at 70% 60%, rgba(120,255,204,.10), transparent 45%);
  }
  .node{
    position:absolute; left:50%; top:50%;
    transform:translate(-50%,-50%);
    width:28px; height:28px; border-radius:50%;
    background:#6aa7ff;
    box-shadow:0 0 24px rgba(106,167,255,.6);
    cursor:pointer;
  }
  .label{
    position:absolute; top:36px; left:50%;
    transform:translateX(-50%);
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    font-size:12px; opacity:.85;
    white-space:nowrap;
  }

  /* ================= DEMO SCENE ================= */
  #scene{
    position:fixed; inset:0;
    display:none; align-items:center; justify-content:center;
    background:#05070d;
    z-index:20;
  }
  .card{
    max-width:720px;
    padding:28px;
    border-radius:18px;
    border:1px solid rgba(255,255,255,.15);
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    text-align:center;
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  }
  .card h2{margin:0 0 12px; font-weight:500}
  .card p{opacity:.85;line-height:1.6;margin:0}
  .close-btn{
    margin-top:24px;
    padding:10px 22px;
    background:transparent;
    border:1px solid rgba(255,255,255,.35);
    color:#e8eefc;
    cursor:pointer;
    letter-spacing:.06em;
    user-select:none;
  }

  .hint{
    position:fixed;
    left:16px; bottom:16px;
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    font-size:12px; opacity:.6;
    z-index:5;
    user-select:none;
  }

  @media (prefers-reduced-motion: reduce){
    #cloud{display:none}
  }
</style>
</head>

<body>

<!-- INTRO -->
<div id="intro">
  <div id="stage">
    <div id="cloud"></div>
  </div>

  <div class="intro-content" id="center">
    <h1>Навчання — це подорож</h1>
    <p>Перед тобою історія курсу.<br>Це лише вступ. Далі — глибше.</p>
    <button id="enterBtn">ENTER</button>
  </div>
</div>

<!-- MAP -->
<div id="wrap">
  <div id="space">
    <div class="node" id="demoNode">
      <div class="label">Демо-урок</div>
    </div>
  </div>
</div>

<!-- DEMO SCENE -->
<div id="scene">
  <div class="card">
    <h2>Демо-урок</h2>
    <p>Це приклад формату навчання.<br>Повний шлях відкривається після входу.</p>
    <button class="close-btn" id="closeScene">Повернутись</button>
  </div>
</div>

<div class="hint">ENTER → “вихор” → карта · На карті: перетягуй · Коліщатко — zoom</div>

<script>
/* ========= YEARS (тільки 4-значні) =========
   Зараз: 30 років 1990–2019. Можеш змінити на будь-які 30 років.
*/
const YEARS = Array.from({length:30}, (_,i)=> String(1990+i));

const cloud = document.getElementById('cloud');
const centerEl = document.getElementById('center');
const enterBtn = document.getElementById('enterBtn');
const intro = document.getElementById('intro');
const wrap = document.getElementById('wrap');

function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }
function easeInOutCubic(x){ return x < 0.5 ? 4*x*x*x : 1 - Math.pow(-2*x + 2, 3)/2; }

/* ========= Build 3D sphere distribution (golden spiral) ========= */
const items = YEARS.map((y, i) => {
  const el = document.createElement('div');
  el.className = 'year';
  el.textContent = y;
  cloud.appendChild(el);

  // golden spiral on sphere
  const n = YEARS.length;
  const phi = Math.acos(1 - 2*(i + 0.5)/n);           // polar
  const theta = Math.PI * (1 + Math.sqrt(5)) * i;    // azimuth (golden angle)

  // unit sphere coords
  const x = Math.cos(theta) * Math.sin(phi);
  const yv = Math.sin(theta) * Math.sin(phi);
  const z = Math.cos(phi);

  return {
    el,
    // base position on unit sphere
    x0: x,
    y0: yv,
    z0: z,
    // tiny personal jitter to avoid perfect math look
    j: (Math.random()*0.12 - 0.06),
    // phase for breathing
    ph: Math.random()*Math.PI*2
  };
});

/* ========= Motion state ========= */
let vortex = false;
let vortexStart = 0;

// slow global rotations (VERY slow drift)
let rotY = 0;
let rotX = 0;

// show ENTER after pause
setTimeout(()=>{
  enterBtn.style.opacity = '1';
  enterBtn.style.pointerEvents = 'auto';
}, 2200);

enterBtn.addEventListener('click', ()=>{
  if(vortex) return;
  vortex = true;
  vortexStart = performance.now();
});

/* ========= 3D helpers ========= */
function rotateY(x,z,a){
  const ca=Math.cos(a), sa=Math.sin(a);
  return { x: x*ca + z*sa, z: -x*sa + z*ca };
}
function rotateX(y,z,a){
  const ca=Math.cos(a), sa=Math.sin(a);
  return { y: y*ca - z*sa, z: y*sa + z*ca };
}

let last = performance.now();
function tick(now){
  const dt = (now - last) / 1000;
  last = now;

  // center of intro text block (critical fix)
  const rect = centerEl.getBoundingClientRect();
  const cx = rect.left + rect.width/2;
  const cy = rect.top + rect.height/2;

  // cloud radius tied to screen (keeps it around text)
  const minSide = Math.min(window.innerWidth, window.innerHeight);
  const R = clamp(minSide * 0.22, 140, 260); // tighter & denser around text

  // progress for vortex
  const p = vortex ? clamp((now - vortexStart)/1600, 0, 1) : 0;
  const pe = easeInOutCubic(p);

  // base drift (super slow)
  const baseRotSpeed = 0.14; // radians per second *very slow feel
  rotY += baseRotSpeed * dt * 0.25;
  rotX += baseRotSpeed * dt * 0.12;

  // in vortex: spin up hard
  const spinBoost = vortex ? (1 + pe*10.0) : 1;
  const aY = rotY * spinBoost;
  const aX = rotX * spinBoost;

  items.forEach((it, i) => {
    // start from sphere, add tiny jitter
    let x = (it.x0 + it.j) * R;
    let y = (it.y0 + it.j*0.7) * (R * 0.78);
    let z = (it.z0 + it.j*0.5) * (R * 1.25);

    // subtle breathing makes it alive (small)
    const breathe = Math.sin(now*0.00045 + it.ph) * 6;
    x += (it.x0) * breathe;
    y += (it.y0) * breathe;

    // rotate sphere slowly
    let ry = rotateY(x, z, aY); x = ry.x; z = ry.z;
    let rx = rotateX(y, z, aX); y = rx.y; z = rx.z;

    // vortex: collapse radius & shoot into camera
    // collapse to center
    const collapse = vortex ? (1 - pe) : 1;
    x *= collapse;
    y *= collapse;

    // Z fly forward in vortex (camera hit)
    const zFly = vortex ? (pe * (1150 + i*6)) : 0;
    z += zFly;

    // perspective-ish scaling by depth
    // normalize z to 0..1 for opacity/scale
    const zNorm = clamp((z + 260) / 900, 0, 1);
    const scale = 0.78 + zNorm * 0.85;        // near bigger
    const opacity = clamp(0.08 + zNorm * 0.52, 0.06, 0.62);

    // blur only during vortex to imitate “into lens”
    const blur = vortex ? (pe*2.0) : 0;

    it.el.style.opacity = opacity.toFixed(3);
    it.el.style.filter = `blur(${blur}px)`;
    it.el.style.transform =
      `translate3d(${cx + x}px, ${cy + y}px, ${z}px) translate(-50%,-50%) scale(${scale})`;
  });

  // finish transition to map
  if(vortex && p >= 1){
    intro.style.opacity = '0';
    setTimeout(()=>{
      intro.style.display = 'none';
      wrap.style.opacity = '1';
      wrap.style.pointerEvents = 'auto';
    }, 900);
    vortex = false;
    return;
  }

  requestAnimationFrame(tick);
}
requestAnimationFrame(tick);

/* ========= MAP PAN/ZOOM + DEMO SCENE ========= */
const space = document.getElementById('space');
let scale=1, mx=0, my=0, drag=false, sx=0, sy=0;

function apply(){ space.style.transform = `translate(${mx}px, ${my}px) scale(${scale})`; }

wrap.addEventListener('mousedown', e=>{ drag=true; sx=e.clientX-mx; sy=e.clientY-my; });
window.addEventListener('mouseup', ()=>drag=false);
window.addEventListener('mousemove', e=>{
  if(!drag) return;
  mx=e.clientX-sx; my=e.clientY-sy; apply();
});
wrap.addEventListener('wheel', e=>{
  e.preventDefault();
  scale *= e.deltaY>0 ? 0.9 : 1.1;
  scale = Math.max(0.4, Math.min(2.5, scale));
  apply();
}, {passive:false});

const scene = document.getElementById('scene');
document.getElementById('demoNode').onclick = ()=> scene.style.display='flex';
document.getElementById('closeScene').onclick = ()=> scene.style.display='none';
</script>

</body>
</html>
