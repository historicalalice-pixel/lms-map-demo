<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>LMS Map — Demo</title>

<style>
  *{box-sizing:border-box}
  html,body{
    margin:0; padding:0; height:100%;
    background:#05070d; color:#e8eefc;
    font-family: system-ui, -apple-system, Segoe UI, Roboto;
    overflow:hidden;
  }

  /* ================= INTRO ================= */
  #intro{
    position:fixed; inset:0;
    background:
      radial-gradient(1200px 700px at 50% 40%, rgba(106,167,255,.12), transparent 55%),
      radial-gradient(900px 650px at 70% 70%, rgba(120,255,204,.06), transparent 55%),
      #05070d;
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:10;
    transition: opacity 1.1s ease;
  }

  #stage{
    position:absolute; inset:0;
    perspective: 900px;
    transform-style: preserve-3d;
    overflow:hidden;
  }

  #cloud{
    position:absolute; inset:0;
    transform-style: preserve-3d;
    pointer-events:none;
  }

  .intro-content{
    position:relative;
    z-index:3;
    text-align:center;
    width:min(900px, 92vw);
    padding:24px;
    pointer-events:none;
  }
  .intro-content h1{
    margin:0 0 14px;
    font-weight:600;
    letter-spacing:.02em;
    font-size: clamp(34px, 4.8vw, 58px);
    line-height:1.12;
    text-wrap: balance;
  }
  .intro-content p{
    margin:0 0 30px;
    opacity:.72;
    line-height:1.6;
    font-size: clamp(13px, 1.45vw, 16px);
  }

  #enterBtn{
    pointer-events:auto;
    opacity:0;
    padding:12px 30px;
    background:transparent;
    border:1px solid rgba(255,255,255,.35);
    color:#e8eefc;
    letter-spacing:.14em;
    text-transform:uppercase;
    cursor:pointer;
    transition:opacity 1.2s ease, border-color .3s ease, transform .25s ease;
  }
  #enterBtn:hover{ border-color:#fff; transform: translateY(-1px); }

  /* --- Date items (no bubbles, just “ghost text in space”) --- */
  .date{
    position:absolute;
    left:50%; top:50%;
    transform-style: preserve-3d;
    will-change: transform, opacity, filter;
    font-size: 12px;
    letter-spacing: .08em;
    color: rgba(232,238,252,.95);
    opacity:.20;
    white-space:nowrap;
    text-shadow: 0 0 10px rgba(0,0,0,.35);
  }

  /* ================= MAP ================= */
  #wrap{
    position:fixed; inset:0;
    opacity:0; pointer-events:none;
    transition: opacity 1s ease;
    z-index:1;
  }
  #space{
    position:absolute;
    left:50%; top:50%;
    width:3000px; height:2000px;
    transform: translate(-50%,-50%) scale(1);
    background:
      radial-gradient(800px 400px at 30% 30%, rgba(106,167,255,.15), transparent 50%),
      radial-gradient(700px 500px at 70% 60%, rgba(120,255,204,.10), transparent 45%);
  }
  .node{
    position:absolute; left:50%; top:50%;
    transform:translate(-50%,-50%);
    width:28px; height:28px; border-radius:50%;
    background:#6aa7ff;
    box-shadow:0 0 24px rgba(106,167,255,.6);
    cursor:pointer;
  }
  .label{
    position:absolute; top:36px; left:50%;
    transform:translateX(-50%);
    font-size:12px; opacity:.85;
    white-space:nowrap;
  }

  /* ================= DEMO SCENE ================= */
  #scene{
    position:fixed; inset:0;
    display:none; align-items:center; justify-content:center;
    background:#05070d;
    z-index:20;
  }
  .card{
    max-width:720px;
    padding:28px;
    border-radius:18px;
    border:1px solid rgba(255,255,255,.15);
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    text-align:center;
  }
  .card h2{margin:0 0 12px}
  .card p{opacity:.85;line-height:1.6;margin:0}
  .close-btn{
    margin-top:24px;
    padding:10px 22px;
    background:transparent;
    border:1px solid rgba(255,255,255,.35);
    color:#e8eefc;
    cursor:pointer;
  }

  .hint{
    position:fixed;
    left:16px; bottom:16px;
    font-size:12px; opacity:.6;
    z-index:5;
  }

  @media (prefers-reduced-motion: reduce){
    #cloud{display:none}
  }
</style>
</head>

<body>

<!-- INTRO -->
<div id="intro">
  <div id="stage">
    <div id="cloud"></div>
  </div>

  <div class="intro-content" id="center">
    <h1>Навчання — це подорож</h1>
    <p>Перед тобою історія курсу.<br>Це лише вступ. Далі — глибше.</p>
    <button id="enterBtn">ENTER</button>
  </div>
</div>

<!-- MAP -->
<div id="wrap">
  <div id="space">
    <div class="node" id="demoNode">
      <div class="label">Демо-урок</div>
    </div>
  </div>
</div>

<!-- DEMO SCENE -->
<div id="scene">
  <div class="card">
    <h2>Демо-урок</h2>
    <p>Це приклад формату навчання.<br>Повний шлях відкривається після входу.</p>
    <button class="close-btn" id="closeScene">Повернутись</button>
  </div>
</div>

<div class="hint">ENTER → “вихор” → карта · На карті: перетягуй · Коліщатко — zoom</div>

<script>
/* ========= DATES LIST (приклад як на твоєму скріні) =========
   Можеш потім замінити на свої 30 дат/подій (рядками).
*/
const DATES = [
  "1840","1362","1918","1941","1932–33","945","2014","19…",
  "1648","1709","1772","1795","1917","1921","1939","1945",
  "1954","1961","1979","1986","1991","1994","2004","2008",
  "2010","2011","2013","2015","2022","2024"
];

const cloud = document.getElementById('cloud');
const centerEl = document.getElementById('center');
const enterBtn = document.getElementById('enterBtn');
const intro = document.getElementById('intro');
const wrap = document.getElementById('wrap');

/* ========= BUILD CLOUD ITEMS ========= */
const items = DATES.map((txt, i) => {
  const el = document.createElement('div');
  el.className = 'date';
  el.textContent = txt;
  cloud.appendChild(el);

  // “3D cloud” params
  const a0 = (i / DATES.length) * Math.PI * 2;
  return {
    el,
    a: a0,
    a0,
    // VERY slow orbit
    speed: (0.010 + Math.random()*0.012) * (Math.random() < 0.5 ? -1 : 1), // rad/sec (slow)
    // random radius offset so it looks like a cloud, not perfect ring
    rJitter: (Math.random()*120 - 60),
    yJitter: (Math.random()*90 - 45),
    // depth: some dates nearer, some farther (like your reference)
    zBase: -220 + Math.random()*320, // [-220..100]
    zPhase: Math.random()*Math.PI*2,
    // small “breathing”
    wobPhase: Math.random()*Math.PI*2
  };
});

function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }
function easeInOutCubic(x){ return x < 0.5 ? 4*x*x*x : 1 - Math.pow(-2*x + 2, 3)/2; }

let vortex = false;
let vortexStart = 0;

setTimeout(()=>{
  enterBtn.style.opacity = '1';
  enterBtn.style.pointerEvents = 'auto';
}, 2200);

enterBtn.addEventListener('click', ()=>{
  if(vortex) return;
  vortex = true;
  vortexStart = performance.now();
});

/* ========= ANIMATE ========= */
let last = performance.now();
function tick(now){
  const dt = (now - last) / 1000;
  last = now;

  const rect = centerEl.getBoundingClientRect();
  const cx = rect.left + rect.width/2;
  const cy = rect.top + rect.height/2;

  // radius around the title (responsive)
  const minSide = Math.min(window.innerWidth, window.innerHeight);
  const baseR = clamp(minSide * 0.30, 220, 380);

  // vortex progress
  const p = vortex ? clamp((now - vortexStart)/1600, 0, 1) : 0;
  const pe = easeInOutCubic(p);

  items.forEach((it, i) => {
    // slow orbit
    it.a += it.speed * dt;

    // cloud-like wobble (very small)
    const wob = Math.sin(now*0.00035 + it.wobPhase) * 10;
    const wobY = Math.cos(now*0.00028 + it.wobPhase) * 8;

    // In vortex: accelerate spin and collapse radius
    const spinBoost = vortex ? (1 + pe*7.0) : 1;
    const a = it.a * spinBoost;

    const r = vortex ? (baseR + it.rJitter + wob) * (1 - pe) : (baseR + it.rJitter + wob);
    const x = Math.cos(a) * r;
    const y = Math.sin(a) * r * 0.70 + it.yJitter + wobY;

    // depth breathing (gives layered look)
    const zIdle = it.zBase + Math.sin(now*0.00035 + it.zPhase)*22;

    // In vortex: shoot into camera
    const z = vortex ? (zIdle + pe * (1200 + i*10)) : zIdle;

    // Perceived size/opacity by depth
    const zNorm = (z + 260) / 700; // rough normalize
    const scale = 0.85 + clamp(zNorm, 0, 1) * 0.55; // near -> bigger
    const opacity = clamp(0.10 + clamp(zNorm,0,1) * 0.40, 0.08, 0.55);
    const blur = vortex ? (pe*1.8) : 0;

    it.el.style.opacity = opacity.toFixed(3);
    it.el.style.filter = `blur(${blur}px)`;

    it.el.style.transform =
      `translate3d(${cx + x}px, ${cy + y}px, ${z}px) translate(-50%, -50%) scale(${scale})`;
  });

  // finish transition
  if(vortex && p >= 1){
    intro.style.opacity = '0';
    setTimeout(()=>{
      intro.style.display = 'none';
      wrap.style.opacity = '1';
      wrap.style.pointerEvents = 'auto';
    }, 900);
    vortex = false;
    return;
  }

  requestAnimationFrame(tick);
}
requestAnimationFrame(tick);

/* ========= MAP PAN/ZOOM + DEMO SCENE ========= */
const space = document.getElementById('space');
let scale=1, mx=0, my=0, drag=false, sx=0, sy=0;

function apply(){ space.style.transform = `translate(${mx}px, ${my}px) scale(${scale})`; }

wrap.addEventListener('mousedown', e=>{ drag=true; sx=e.clientX-mx; sy=e.clientY-my; });
window.addEventListener('mouseup', ()=>drag=false);
window.addEventListener('mousemove', e=>{
  if(!drag) return;
  mx=e.clientX-sx; my=e.clientY-sy; apply();
});
wrap.addEventListener('wheel', e=>{
  e.preventDefault();
  scale *= e.deltaY>0 ? 0.9 : 1.1;
  scale = Math.max(0.4, Math.min(2.5, scale));
  apply();
}, {passive:false});

const scene = document.getElementById('scene');
document.getElementById('demoNode').onclick = ()=> scene.style.display='flex';
document.getElementById('closeScene').onclick = ()=> scene.style.display='none';
</script>

</body>
</html>
